{% extends 'base.html' %}
{% load static %}

{% block title %}–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–∞–º–∏ –∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏{% endblock %}

{% block meta_description %}–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç–∞–º–∏ Billify - —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Å—á–µ—Ç–∞ –≤ –µ–¥–∏–Ω–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏—è, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –æ–ø–ª–∞—Ç—ã —Å—á–µ—Ç–æ–≤ –¥–ª—è –º–∞–ª–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞.{% endblock %}

{% block meta_keywords %}—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–∞–º–∏, –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–æ–≤, –æ–ø–ª–∞—Ç–∞ —Å—á–µ—Ç–æ–≤, —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π —É—á–µ—Ç, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å–∞, —É—á–µ—Ç –¥–ª—è –ò–ü, –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç, –≤—Ö–æ–¥—è—â–∏–µ —Å—á–µ—Ç–∞, –∏—Å—Ö–æ–¥—è—â–∏–µ —Å—á–µ—Ç–∞{% endblock %}

{% block og_title %}–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–∞–º–∏ –∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏ | Billify - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ —É—á–µ—Ç–∞{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/clients/list.css">
{% endblock %}

{% block content %}
<!-- Schema.org –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫–∞ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å—á–µ—Ç–æ–≤ -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "ItemList",
  "name": "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–∞–º–∏ –∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏ –≤ Billify",
  "description": "–°–∏—Å—Ç–µ–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å—á–µ—Ç–æ–≤ –≤ –±–∏–∑–Ω–µ—Å–µ",
  "numberOfItems": "{{ total_count|default:'0' }}",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "–í—Ö–æ–¥—è—â–∏–µ —Å—á–µ—Ç–∞",
      "url": "{{ request.build_absolute_uri }}?type=incoming",
      "description": "–°—á–µ—Ç–∞ –æ—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ —É—Å–ª—É–≥ –∏–ª–∏ —Ç–æ–≤–∞—Ä–æ–≤"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "–ò—Å—Ö–æ–¥—è—â–∏–µ —Å—á–µ—Ç–∞",
      "url": "{{ request.build_absolute_uri }}?type=outgoing",
      "description": "–°—á–µ—Ç–∞ –¥–ª—è –≤–∞—à–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤"
    }
  ]
}
</script>

<div class="clients-page">
    <div class="page-header d-flex justify-content-between align-items-center mb-3">
        <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–∞–º–∏</h1>
        <div>
            <a href="{% url 'invoices:create_incoming' %}" class="btn-add mr-2">–í—Ö–æ–¥—è—â–∏–π —Å—á–µ—Ç</a>
            <a href="{% url 'invoices:create_outgoing' %}" class="btn-add">–ò—Å—Ö–æ–¥—è—â–∏–π —Å—á–µ—Ç</a>
        </div>
    </div>
    
    <div class="filters card mb-3">
        <form method="get" action="{% url 'invoices:list' %}" class="d-flex">
            <div class="search-box">
                <input type="text" name="search" value="{{ search_query }}" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É –∏–ª–∏ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—É...">
                <span class="search-icon">üîç</span>
            </div>
            
            <div class="type-filter">
                <select name="type" aria-label="–§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É —Å—á–µ—Ç–∞">
                    <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                    <option value="incoming" {% if current_type == 'incoming' %}selected{% endif %}>–í—Ö–æ–¥—è—â–∏–µ</option>
                    <option value="outgoing" {% if current_type == 'outgoing' %}selected{% endif %}>–ò—Å—Ö–æ–¥—è—â–∏–µ</option>
                </select>
            </div>
            
            <div class="entity-filter">
                <select name="status" aria-label="–§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É">
                    <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                    <option value="new" {% if status == 'new' %}selected{% endif %}>–ù–æ–≤—ã–π</option>
                    <option value="sent" {% if status == 'sent' %}selected{% endif %}>–û—Ç–ø—Ä–∞–≤–ª–µ–Ω</option>
                    <option value="pending" {% if status == 'pending' %}selected{% endif %}>–û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã</option>
                    <option value="paid" {% if status == 'paid' %}selected{% endif %}>–û–ø–ª–∞—á–µ–Ω</option>
                    <option value="overdue" {% if status == 'overdue' %}selected{% endif %}>–ü—Ä–æ—Å—Ä–æ—á–µ–Ω</option>
                    <option value="cancelled" {% if status == 'cancelled' %}selected{% endif %}>–û—Ç–º–µ–Ω–µ–Ω</option>
                </select>
            </div>
            
            <div class="filter-buttons">
                <button type="submit" class="btn-apply">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                <a href="{% url 'invoices:list' %}" class="btn-reset">–°–±—Ä–æ—Å–∏—Ç—å</a>
            </div>
        </form>
    </div>
    
    {% if invoices %}
        <div class="clients-list">
            <table>
                <thead>
                    <tr>
                        <th>‚Ññ —Å—á–µ—Ç–∞</th>
                        <th>
                            {% if current_type == 'incoming' %}
                                –ü–æ—Å—Ç–∞–≤—â–∏–∫
                            {% elif current_type == 'outgoing' %}
                                –ö–ª–∏–µ–Ω—Ç
                            {% else %}
                                –ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç
                            {% endif %}
                        </th>
                        <th>–î–∞—Ç–∞</th>
                        <th>–°—É–º–º–∞</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    {% for invoice in invoices %}
                        <tr>
                            <td>
                                <a href="{% url 'invoices:detail' invoice.id %}" class="client-name">
                                    {{ invoice.number }}
                                </a>
                            </td>
                            <td>
                                {% if current_type == 'incoming' %}
                                    {{ invoice.supplier_name }}
                                {% elif current_type == 'outgoing' %}
                                    {{ invoice.client.name }}
                                {% else %}
                                    {% if invoice.supplier_name == user.company_profile.company_name %}
                                        {{ invoice.client.name }}
                                    {% else %}
                                        {{ invoice.supplier_name }}
                                    {% endif %}
                                {% endif %}
                            </td>
                            <td>{{ invoice.issue_date|date:"d.m.Y" }}</td>
                            <td>{{ invoice.total }} ‚ÇΩ</td>
                            <td>
                                <span class="entity-badge {% if invoice.status == 'paid' %}client-badge{% elif invoice.status == 'overdue' %}supplier-badge{% else %}type-badge individual-badge{% endif %}">
                                    {% if invoice.status == 'new' %}
                                        –ù–æ–≤—ã–π
                                    {% elif invoice.status == 'sent' %}
                                        –û—Ç–ø—Ä–∞–≤–ª–µ–Ω
                                    {% elif invoice.status == 'pending' %}
                                        –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã
                                    {% elif invoice.status == 'paid' %}
                                        –û–ø–ª–∞—á–µ–Ω
                                    {% elif invoice.status == 'overdue' %}
                                        –ü—Ä–æ—Å—Ä–æ—á–µ–Ω
                                    {% elif invoice.status == 'cancelled' %}
                                        –û—Ç–º–µ–Ω–µ–Ω
                                    {% else %}
                                        {{ invoice.status }}
                                    {% endif %}
                                </span>
                            </td>
                            <td class="actions">
                                <a href="{% url 'invoices:detail' invoice.id %}" class="btn-action btn-view" title="–ü—Ä–æ—Å–º–æ—Ç—Ä">
                                    <span class="btn-icon">üëÅÔ∏è</span>
                                </a>
                                <a href="{% url 'invoices:edit' invoice.id %}" class="btn-action btn-edit" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                                    <span class="btn-icon">‚úèÔ∏è</span>
                                </a>
                                <a href="{% url 'invoices:pdf' invoice.id %}" class="btn-action btn-view" title="PDF">
                                    <span class="btn-icon">üìÑ</span>
                                </a>
                                <a href="{% url 'invoices:delete' invoice.id %}" class="btn-action btn-delete" title="–£–¥–∞–ª–∏—Ç—å" onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Å—á–µ—Ç?');">
                                    <span class="btn-icon">üóëÔ∏è</span>
                                </a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        {% if invoices.has_other_pages %}
            <div class="pagination">
                <ul class="pagination-list">
                    {% if invoices.has_previous %}
                        <li><a href="?page=1{% if search_query %}&search={{ search_query }}{% endif %}{% if current_type %}&type={{ current_type }}{% endif %}{% if status %}&status={{ status }}{% endif %}">&laquo; –ü–µ—Ä–≤–∞—è</a></li>
                        <li><a href="?page={{ invoices.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if current_type %}&type={{ current_type }}{% endif %}{% if status %}&status={{ status }}{% endif %}">–ü—Ä–µ–¥—ã–¥—É—â–∞—è</a></li>
                    {% endif %}
                    
                    {% for num in invoices.paginator.page_range %}
                        {% if invoices.number == num %}
                            <li class="active"><span>{{ num }}</span></li>
                        {% elif num > invoices.number|add:'-3' and num < invoices.number|add:'3' %}
                            <li><a href="?page={{ num }}{% if search_query %}&search={{ search_query }}{% endif %}{% if current_type %}&type={{ current_type }}{% endif %}{% if status %}&status={{ status }}{% endif %}">{{ num }}</a></li>
                        {% endif %}
                    {% endfor %}
                    
                    {% if invoices.has_next %}
                        <li><a href="?page={{ invoices.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if current_type %}&type={{ current_type }}{% endif %}{% if status %}&status={{ status }}{% endif %}">–°–ª–µ–¥—É—é—â–∞—è</a></li>
                        <li><a href="?page={{ invoices.paginator.num_pages }}{% if search_query %}&search={{ search_query }}{% endif %}{% if current_type %}&type={{ current_type }}{% endif %}{% if status %}&status={{ status }}{% endif %}">–ü–æ—Å–ª–µ–¥–Ω—è—è &raquo;</a></li>
                    {% endif %}
                </ul>
            </div>
        {% endif %}
    {% else %}
        <div class="empty-state card">
            <div class="empty-state-content">
                <div class="empty-icon">üìë</div>
                <h2>–ù–µ—Ç —Å—á–µ—Ç–æ–≤</h2>
                <p>–í —Å–∏—Å—Ç–µ–º–µ –ø–æ–∫–∞ –Ω–µ—Ç —Å—á–µ—Ç–æ–≤{% if search_query or current_type or status %}, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–¥–∞–Ω–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º{% endif %}.</p>
                <div class="empty-actions">
                    <a href="{% url 'invoices:create_incoming' %}" class="btn-add">–°–æ–∑–¥–∞—Ç—å –≤—Ö–æ–¥—è—â–∏–π</a>
                    <a href="{% url 'invoices:create_outgoing' %}" class="btn-add">–°–æ–∑–¥–∞—Ç—å –∏—Å—Ö–æ–¥—è—â–∏–π</a>
                    {% if search_query or current_type or status %}
                        <a href="{% url 'invoices:list' %}" class="btn-reset">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</a>
                    {% endif %}
                </div>
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<script src="/static/js/invoices/list.js"></script>
{% endblock %} 
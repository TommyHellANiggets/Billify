{% extends 'base.html' %}
{% load i18n %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/clients/list.css">
{% endblock %}

{% block content %}
<div class="clients-page">
    <div class="page-header d-flex justify-content-between align-items-center mb-3">
        <h1>{% trans "–ö–ª–∏–µ–Ω—Ç—ã –∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏" %}</h1>
        <a href="{% url 'clients:create' %}" class="btn-add">{% trans "–î–æ–±–∞–≤–∏—Ç—å" %}</a>
    </div>
    
    <div class="filters card mb-3">
        <form method="get" action="{% url 'clients:list' %}" class="d-flex">
            <div class="search-box">
                <input type="text" name="search" value="{{ search_query }}" placeholder="{% trans "–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏..." %}">
                <span class="search-icon">üîç</span>
            </div>
            
            <div class="type-filter">
                <select name="type" aria-label="{% trans "–§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É –∫–ª–∏–µ–Ω—Ç–∞" %}">
                    <option value="">{% trans "–í—Å–µ —Ç–∏–ø—ã" %}</option>
                    {% for type_value, type_name in client_types %}
                        <option value="{{ type_value }}" {% if client_type == type_value %}selected{% endif %}>{{ type_name }}</option>
                    {% endfor %}
                </select>
            </div>
            
            <div class="entity-filter">
                <select name="entity_type" aria-label="{% trans "–§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É" %}">
                    <option value="">{% trans "–í—Å–µ" %}</option>
                    <option value="client" {% if entity_type == 'client' %}selected{% endif %}>{% trans "–ö–ª–∏–µ–Ω—Ç—ã" %}</option>
                    <option value="supplier" {% if entity_type == 'supplier' %}selected{% endif %}>{% trans "–ü–æ—Å—Ç–∞–≤—â–∏–∫–∏" %}</option>
                </select>
            </div>
            
            <div class="filter-buttons">
                <button type="submit" class="btn-apply">{% trans "–ü—Ä–∏–º–µ–Ω–∏—Ç—å" %}</button>
                <a href="{% url 'clients:list' %}" class="btn-reset">{% trans "–°–±—Ä–æ—Å–∏—Ç—å" %}</a>
            </div>
        </form>
    </div>
    
    {% if entities %}
        <div class="clients-list">
            <table>
                <thead>
                    <tr>
                        <th>{% trans "–ò–º—è / –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è" %}</th>
                        <th>{% trans "–°—Ç–∞—Ç—É—Å" %}</th>
                        <th>{% trans "–¢–∏–ø" %}</th>
                        <th>{% trans "–¢–µ–ª–µ—Ñ–æ–Ω" %}</th>
                        <th>{% trans "Email" %}</th>
                        <th>{% trans "–î–µ–π—Å—Ç–≤–∏—è" %}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for client in entities %}
                        <tr>
                            <td>
                                <a href="{% url 'clients:detail' client_id=client.id %}" class="client-name">
                                    {{ client.name }}
                                </a>
                            </td>
                            <td>
                                <span class="entity-badge {% if client.is_supplier %}supplier-badge{% else %}client-badge{% endif %}">
                                    {% if client.is_supplier %}{% trans "–ü–æ—Å—Ç–∞–≤—â–∏–∫" %}{% else %}{% trans "–ö–ª–∏–µ–Ω—Ç" %}{% endif %}
                                </span>
                            </td>
                            <td>
                                <span class="type-badge {% if client.type == 'individual' %}individual-badge{% else %}business-badge{% endif %}">
                                    {{ client.type_display }}
                                </span>
                            </td>
                            <td>{{ client.phone|default:"-" }}</td>
                            <td>{{ client.email|default:"-" }}</td>
                            <td class="actions">
                                <a href="{% url 'clients:detail' client_id=client.id %}" class="btn-action btn-view" title="{% trans "–ü—Ä–æ—Å–º–æ—Ç—Ä" %}">
                                    <span class="btn-icon">üëÅÔ∏è</span>
                                </a>
                                <a href="{% url 'clients:edit' client_id=client.id %}" class="btn-action btn-edit" title="{% trans "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" %}">
                                    <span class="btn-icon">‚úèÔ∏è</span>
                                </a>
                                <a href="{% url 'clients:delete' client_id=client.id %}" class="btn-action btn-delete" title="{% trans "–£–¥–∞–ª–∏—Ç—å" %}">
                                    <span class="btn-icon">üóëÔ∏è</span>
                                </a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        {% if entities.has_other_pages %}
            <div class="pagination">
                <ul class="pagination-list">
                    {% if entities.has_previous %}
                        <li><a href="?page=1{% if search_query %}&search={{ search_query }}{% endif %}{% if client_type %}&type={{ client_type }}{% endif %}{% if entity_type %}&entity_type={{ entity_type }}{% endif %}">{% trans "&laquo; –ü–µ—Ä–≤–∞—è" %}</a></li>
                        <li><a href="?page={{ entities.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if client_type %}&type={{ client_type }}{% endif %}{% if entity_type %}&entity_type={{ entity_type }}{% endif %}">{% trans "–ü—Ä–µ–¥—ã–¥—É—â–∞—è" %}</a></li>
                    {% endif %}
                    
                    {% for num in entities.paginator.page_range %}
                        {% if entities.number == num %}
                            <li class="active"><span>{{ num }}</span></li>
                        {% elif num > entities.number|add:'-3' and num < entities.number|add:'3' %}
                            <li><a href="?page={{ num }}{% if search_query %}&search={{ search_query }}{% endif %}{% if client_type %}&type={{ client_type }}{% endif %}{% if entity_type %}&entity_type={{ entity_type }}{% endif %}">{{ num }}</a></li>
                        {% endif %}
                    {% endfor %}
                    
                    {% if entities.has_next %}
                        <li><a href="?page={{ entities.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if client_type %}&type={{ client_type }}{% endif %}{% if entity_type %}&entity_type={{ entity_type }}{% endif %}">{% trans "–°–ª–µ–¥—É—é—â–∞—è" %}</a></li>
                        <li><a href="?page={{ entities.paginator.num_pages }}{% if search_query %}&search={{ search_query }}{% endif %}{% if client_type %}&type={{ client_type }}{% endif %}{% if entity_type %}&entity_type={{ entity_type }}{% endif %}">{% trans "–ü–æ—Å–ª–µ–¥–Ω—è—è &raquo;" %}</a></li>
                    {% endif %}
                </ul>
            </div>
        {% endif %}
    {% else %}
        <div class="empty-state card">
            <div class="empty-state-content">
                <div class="empty-icon">üë•</div>
                <h2>{% trans "–ù–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤" %}</h2>
                <p>{% trans "–í —Å–∏—Å—Ç–µ–º–µ –ø–æ–∫–∞ –Ω–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤" %}{% if search_query or client_type or entity_type %}{% trans ", —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–¥–∞–Ω–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º" %}{% endif %}.</p>
                <div class="empty-actions">
                    <a href="{% url 'clients:create' %}" class="btn-add">{% trans "–î–æ–±–∞–≤–∏—Ç—å" %}</a>
                    {% if search_query or client_type or entity_type %}
                        <a href="{% url 'clients:list' %}" class="btn-reset">{% trans "–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã" %}</a>
                    {% endif %}
                </div>
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<script src="/static/js/clients/list.js"></script>
{% endblock %} 
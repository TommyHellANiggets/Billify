{% extends 'base.html' %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/clients/list.css">
{% endblock %}

{% block content %}
<div class="clients-page">
    <div class="page-header d-flex justify-content-between align-items-center mb-3">
        <h1>–ö–ª–∏–µ–Ω—Ç—ã</h1>
        <a href="{% url 'clients:create' %}" class="btn">–î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</a>
    </div>
    
    <div class="filters card mb-3">
        <form method="get" action="{% url 'clients:list' %}" class="d-flex">
            <div class="search-box">
                <input type="text" name="search" value="{{ search_query }}" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏...">
            </div>
            
            <div class="type-filter">
                <select name="type">
                    <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                    {% for type_value, type_name in client_types %}
                        <option value="{{ type_value }}" {% if client_type == type_value %}selected{% endif %}>{{ type_name }}</option>
                    {% endfor %}
                </select>
            </div>
            
            <div class="filter-buttons">
                <button type="submit" class="btn">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                <a href="{% url 'clients:list' %}" class="btn btn-secondary">–°–±—Ä–æ—Å–∏—Ç—å</a>
            </div>
        </form>
    </div>
    
    {% if clients %}
        <div class="clients-list">
            <table>
                <thead>
                    <tr>
                        <th>–ò–º—è / –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è</th>
                        <th>–¢–∏–ø</th>
                        <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                        <th>Email</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    {% for client in clients %}
                        <tr>
                            <td>
                                <a href="{% url 'clients:detail' client_id=client.id %}" class="client-name">
                                    {{ client.name }}
                                </a>
                            </td>
                            <td>{{ client.get_type_display }}</td>
                            <td>{{ client.phone|default:"-" }}</td>
                            <td>{{ client.email|default:"-" }}</td>
                            <td class="actions">
                                <a href="{% url 'clients:detail' client_id=client.id %}" class="action-btn view-btn" title="–ü—Ä–æ—Å–º–æ—Ç—Ä">üëÅÔ∏è</a>
                                <a href="{% url 'clients:edit' client_id=client.id %}" class="action-btn edit-btn" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</a>
                                <a href="{% url 'clients:delete' client_id=client.id %}" class="action-btn delete-btn" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        {% if clients.has_other_pages %}
            <div class="pagination">
                <ul class="pagination-list">
                    {% if clients.has_previous %}
                        <li><a href="?page=1{% if search_query %}&search={{ search_query }}{% endif %}{% if client_type %}&type={{ client_type }}{% endif %}">&laquo; –ü–µ—Ä–≤–∞—è</a></li>
                        <li><a href="?page={{ clients.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if client_type %}&type={{ client_type }}{% endif %}">–ü—Ä–µ–¥—ã–¥—É—â–∞—è</a></li>
                    {% endif %}
                    
                    {% for num in clients.paginator.page_range %}
                        {% if clients.number == num %}
                            <li class="active"><span>{{ num }}</span></li>
                        {% elif num > clients.number|add:'-3' and num < clients.number|add:'3' %}
                            <li><a href="?page={{ num }}{% if search_query %}&search={{ search_query }}{% endif %}{% if client_type %}&type={{ client_type }}{% endif %}">{{ num }}</a></li>
                        {% endif %}
                    {% endfor %}
                    
                    {% if clients.has_next %}
                        <li><a href="?page={{ clients.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if client_type %}&type={{ client_type }}{% endif %}">–°–ª–µ–¥—É—é—â–∞—è</a></li>
                        <li><a href="?page={{ clients.paginator.num_pages }}{% if search_query %}&search={{ search_query }}{% endif %}{% if client_type %}&type={{ client_type }}{% endif %}">–ü–æ—Å–ª–µ–¥–Ω—è—è &raquo;</a></li>
                    {% endif %}
                </ul>
            </div>
        {% endif %}
    {% else %}
        <div class="empty-state card">
            <div class="empty-state-content">
                <div class="empty-icon">üë•</div>
                <h2>–ù–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤</h2>
                <p>–í —Å–∏—Å—Ç–µ–º–µ –ø–æ–∫–∞ –Ω–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤{% if search_query or client_type %}, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–¥–∞–Ω–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º{% endif %}.</p>
                <div class="empty-actions">
                    <a href="{% url 'clients:create' %}" class="btn">–î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</a>
                    {% if search_query or client_type %}
                        <a href="{% url 'clients:list' %}" class="btn btn-secondary">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</a>
                    {% endif %}
                </div>
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<script src="/static/js/clients/list.js"></script>
{% endblock %} 